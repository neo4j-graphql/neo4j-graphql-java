:toc:

= Filter Test TCK

== Schema

[source,graphql,schema=true]
----
enum Gender { female, male }
type Person {
  id : ID!
  name: String
  age: Int
  height: Float
  fun: Boolean
  gender: Gender
  company: Company @relation(name:"WORKS_AT")
  location: _Neo4jPoint
}
type Company {
  _id: ID
  name: String
  employees: [Person] @relation(name:"WORKS_AT", direction: IN)
}
type Query {
  person : [Person]
}
----

== Test Data

[source,cypher,test-data=true]
----
CREATE (c:Company {name: 'ACME'})
WITH c
UNWIND [
  {id:       'jane',
   name:     'Jane',
   age:      38,
   gender:   'female',
   fun:      true,
   height:   1.75,
   location: point({longitude: 1, latitude: 2, height: 3})
  },
  {id: 'joe', name: 'Joe', age: 42, gender: 'male', fun: false, height: 1.85}
] AS props
CREATE (p:Person)-[:WORKS_AT]->(c)
SET p = props;

CREATE (c:Company {name: 'ACME2'})
WITH c
UNWIND [{
  id:       'jill',
  name:     'Jill',
  age:      32,
  gender:   'female',
  fun:      true,
  height:   1.65,
  location: point({longitude: 2, latitude: 3, height: 3})
}]
AS props

CREATE (p:Person)-[:WORKS_AT]->(c)
SET p = props
----

== Filter on _Enum_

=== Filter enum _eq_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { gender: male }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_gender" : "male"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.gender = $filter_person_gender
RETURN person {
	.name
} AS person
----

=== Filter enum _not_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { gender_not: male }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_gender_not" : "male"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.gender = $filter_person_gender_not)
RETURN person {
	.name
} AS person
----

=== Filter enum _not_in_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { gender_not_in: [male] }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_gender_not_in" : [ "male" ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.gender IN $filter_person_gender_not_in)
RETURN person {
	.name
} AS person
----

=== Filter enum _in_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { gender_in: [male] }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_gender_in" : [ "male" ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.gender IN $filter_person_gender_in
RETURN person {
	.name
} AS person
----

== Filter on _ID_

=== Filter id _eq_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { id: "jane" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_id" : "jane"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.id = $filter_person_id
RETURN person {
	.name
} AS person
----

=== Filter id _starts_with_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { id_starts_with: "ja" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_id_starts_with" : "ja"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.id STARTS WITH $filter_person_id_starts_with
RETURN person {
	.name
} AS person
----

=== Filter id _not_starts_with_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { id_not_starts_with: "ja" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_id_not_starts_with" : "ja"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.id STARTS WITH $filter_person_id_not_starts_with)
RETURN person {
	.name
} AS person
----

=== Filter id _ends_with_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { id_ends_with: "ne" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_id_ends_with" : "ne"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.id ENDS WITH $filter_person_id_ends_with
RETURN person {
	.name
} AS person
----

=== Filter id _not_ends_with_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { id_not_ends_with: "ne" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_id_not_ends_with" : "ne"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.id ENDS WITH $filter_person_id_not_ends_with)
RETURN person {
	.name
} AS person
----

=== Filter id _contains_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { id_contains: "an" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_id_contains" : "an"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.id CONTAINS $filter_person_id_contains
RETURN person {
	.name
} AS person
----

=== Filter id _not_contains_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { id_not_contains: "an" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_id_not_contains" : "an"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.id CONTAINS $filter_person_id_not_contains)
RETURN person {
	.name
} AS person
----

=== Filter id _in_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { id_in: ["jane"] }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_id_in" : [ "jane" ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.id IN $filter_person_id_in
RETURN person {
	.name
} AS person
----

=== Filter id _not_in_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { id_not_in: ["joe"] }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_id_not_in" : [ "joe" ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.id IN $filter_person_id_not_in)
RETURN person {
	.name
} AS person
----

=== Filter id _not_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { id_not: "joe" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_id_not" : "joe"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.id = $filter_person_id_not)
RETURN person {
	.name
} AS person
----

== Filter on _@nativeId_

=== filter _@nativeId_ _eq_

.GraphQL-Query
[source,graphql]
----
{ company(filter: { _id: 1 }) { name, _id }}
----

.Cypher Params
[source,json]
----
{
  "filter_company__id" : 1
}
----

.Cypher
[source,cypher]
----
MATCH (company:Company)
WHERE id(company) = toInteger($filter_company__id)
RETURN company {
	.name,
	_id: id(company)
} AS company
----

=== filter _@nativeId_ _in_

.GraphQL-Query
[source,graphql]
----
{ company(filter: { _id_in: [1,2] }) { name, _id }}
----

.Cypher Params
[source,json]
----
{
  "filter_company__id_in" : [ 1, 2 ]
}
----

.Cypher
[source,cypher]
----
MATCH (company:Company)
WHERE id(company) IN [id IN $filter_company__id_in | toInteger(id)]
RETURN company {
	.name,
	_id: id(company)
} AS company
----

=== filter _@nativeId_ _not_in_

.GraphQL-Query
[source,graphql]
----
{ company(filter: { _id_not_in: [1,2] }) { name, _id }}
----

.Cypher Params
[source,json]
----
{
  "filter_company__id_not_in" : [ 1, 2 ]
}
----

.Cypher
[source,cypher]
----
MATCH (company:Company)
WHERE NOT (id(company) IN [id IN $filter_company__id_not_in | toInteger(id)])
RETURN company {
	.name,
	_id: id(company)
} AS company
----

=== filter _@nativeId_ _not_

.GraphQL-Query
[source,graphql]
----
{ company(filter: { _id_not: 1 }) { name, _id }}
----

.Cypher Params
[source,json]
----
{
  "filter_company__id_not" : 1
}
----

.Cypher
[source,cypher]
----
MATCH (company:Company)
WHERE NOT (id(company) = toInteger($filter_company__id_not))
RETURN company {
	.name,
	_id: id(company)
} AS company
----

== Filter on _Int_

=== Filter number _eq_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { age: 38 }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_age" : 38
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.age = $filter_person_age
RETURN person {
	.name
} AS person
----

=== Filter number _in_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { age_in: [38] }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_age_in" : [ 38 ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.age IN $filter_person_age_in
RETURN person {
	.name
} AS person
----

=== Filter number _not_in_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { age_not_in: [38] }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_age_not_in" : [ 38 ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.age IN $filter_person_age_not_in)
RETURN person {
	.name
} AS person
----

=== Filter number _lte_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { age_lte: 40 }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_age_lte" : 40
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.age <= $filter_person_age_lte
RETURN person {
	.name
} AS person
----

=== Filter number _lt_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { age_lt: 40 }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_age_lt" : 40
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.age < $filter_person_age_lt
RETURN person {
	.name
} AS person
----

=== Filter number _gt_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { age_gt: 40 }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_age_gt" : 40
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.age > $filter_person_age_gt
RETURN person {
	.name
} AS person
----

=== Filter number _gte_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { age_gte: 40 }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_age_gte" : 40
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.age >= $filter_person_age_gte
RETURN person {
	.name
} AS person
----

== Filter on _Float_

=== Filter float _eq_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { height: 1.75 }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_height" : 1.75
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.height = $filter_person_height
RETURN person {
	.name
} AS person
----

=== Filter float _not_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { height_not: 1.75 }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_height_not" : 1.75
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.height = $filter_person_height_not)
RETURN person {
	.name
} AS person
----

=== Filter float _in_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { height_in: [1.75] }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_height_in" : [ 1.75 ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.height IN $filter_person_height_in
RETURN person {
	.name
} AS person
----

=== Filter float _not_in_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { height_not_in: [1.75] }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_height_not_in" : [ 1.75 ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.height IN $filter_person_height_not_in)
RETURN person {
	.name
} AS person
----

=== Filter float _lte_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { height_lte: 1.80 }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_height_lte" : 1.8
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.height <= $filter_person_height_lte
RETURN person {
	.name
} AS person
----

=== Filter float _lt_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { height_lt: 1.80 }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_height_lt" : 1.8
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.height < $filter_person_height_lt
RETURN person {
	.name
} AS person
----

=== Filter float _gte_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { height_gte: 1.80 }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_height_gte" : 1.8
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.height >= $filter_person_height_gte
RETURN person {
	.name
} AS person
----

=== Filter float _gt_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { height_gt: 1.80 }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_height_gt" : 1.8
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.height > $filter_person_height_gt
RETURN person {
	.name
} AS person
----

== Filter on _String_

=== Filter string _eq_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { name: "Jane" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_name" : "Jane"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.name = $filter_person_name
RETURN person {
	.name
} AS person
----

=== Filter string _starts_with_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { name_starts_with: "Ja" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_name_starts_with" : "Ja"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.name STARTS WITH $filter_person_name_starts_with
RETURN person {
	.name
} AS person
----

=== Filter string _not_starts_with_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { name_not_starts_with: "Ja" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_name_not_starts_with" : "Ja"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.name STARTS WITH $filter_person_name_not_starts_with)
RETURN person {
	.name
} AS person
----

=== Filter string _ends_with_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { name_ends_with: "ne" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_name_ends_with" : "ne"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.name ENDS WITH $filter_person_name_ends_with
RETURN person {
	.name
} AS person
----

=== Filter string _not_ends_with_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { name_not_ends_with: "ne" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_name_not_ends_with" : "ne"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.name ENDS WITH $filter_person_name_not_ends_with)
RETURN person {
	.name
} AS person
----

=== Filter string _contains_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { name_contains: "an" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_name_contains" : "an"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.name CONTAINS $filter_person_name_contains
RETURN person {
	.name
} AS person
----

=== Filter string _not_contains_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { name_not_contains: "an" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_name_not_contains" : "an"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.name CONTAINS $filter_person_name_not_contains)
RETURN person {
	.name
} AS person
----

=== Filter string _in_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { name_in: ["Jane"] }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_name_in" : [ "Jane" ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.name IN $filter_person_name_in
RETURN person {
	.name
} AS person
----

=== Filter string _not_in_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { name_not_in: ["Joe"] }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_name_not_in" : [ "Joe" ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.name IN $filter_person_name_not_in)
RETURN person {
	.name
} AS person
----

=== Filter string _not_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { name_not: "Joe" }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_name_not" : "Joe"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.name = $filter_person_name_not)
RETURN person {
	.name
} AS person
----

== Filter on _Boolean_

=== Filter boolean _eq_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { fun: true }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_fun" : true
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.fun = $filter_person_fun
RETURN person {
	.name
} AS person
----

=== Filter boolean _not_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { fun_not: true }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_fun_not" : true
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person.fun = $filter_person_fun_not)
RETURN person {
	.name
} AS person
----

== Filter on spatial

=== Filter spatial _eq_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { location: {longitude: 1, latitude: 2} }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_location_AND1_longitude" : 1,
  "filter_person_location_AND2_latitude" : 2
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE (person.location.longitude = $filter_person_location_AND1_longitude
	AND person.location.latitude = $filter_person_location_AND2_latitude)
RETURN person {
	.name
} AS person
----

=== Filter spatial _not_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { location_not: {longitude: 1, latitude: 2} }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_location_not_AND1_longitude" : 1,
  "filter_person_location_not_AND2_latitude" : 2
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE (NOT (person.location.longitude = $filter_person_location_not_AND1_longitude)
	AND NOT (person.location.latitude = $filter_person_location_not_AND2_latitude))
RETURN person {
	.name
} AS person
----

=== Filter spatial _null_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { location: null }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  } ]
}
----

.Cypher Params
[source,json]
----
{}
----

.Cypher
[source,cypher]
----
MATCH (person: Person)
WHERE person.location IS NULL
RETURN person { .name } AS person
----

=== Filter spatial _not_null_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { location_not: null }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{}
----

.Cypher
[source,cypher]
----
MATCH (person: Person)
WHERE person.location IS NOT NULL
RETURN person { .name } AS person
----

=== Filter spatial _distance eq_

.GraphQL-Query
[source,graphql]
----
{
  person(filter:{ location_distance: { distance: 3, point: {longitude: 1, latitude:2, height: 3}}}){
    name
  }
}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_location_distance" : {
    "distance" : 3,
    "point" : {
      "longitude" : 1,
      "latitude" : 2,
      "height" : 3
    }
  }
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE distance(person.location, point($filter_person_location_distance.point)) = $filter_person_location_distance.distance
RETURN person {
	.name
} AS person
----

=== Filter spatial _distance lt_

.GraphQL-Query
[source,graphql]
----
{
  person(filter:{ location_distance_lt: { distance: 3, point: {longitude: 1, latitude:2, height: 3}}}){
    name
  }
}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_location_distance_lt" : {
    "distance" : 3,
    "point" : {
      "longitude" : 1,
      "latitude" : 2,
      "height" : 3
    }
  }
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE distance(person.location, point($filter_person_location_distance_lt.point)) < $filter_person_location_distance_lt.distance
RETURN person {
	.name
} AS person
----

=== Filter spatial _distance lte_

.GraphQL-Query
[source,graphql]
----
{
  person(filter:{ location_distance_lte: { distance: 3, point: {longitude: 1, latitude:2, height: 3}}}){
    name
  }
}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_location_distance_lte" : {
    "distance" : 3,
    "point" : {
      "longitude" : 1,
      "latitude" : 2,
      "height" : 3
    }
  }
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE distance(person.location, point($filter_person_location_distance_lte.point)) <= $filter_person_location_distance_lte.distance
RETURN person {
	.name
} AS person
----

=== Filter spatial _distance gt_

.GraphQL-Query
[source,graphql]
----
{
  person(filter:{ location_distance_gt: { distance: 3, point: {longitude: 1, latitude:2, height: 3}}}){
    name
  }
}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_location_distance_gt" : {
    "distance" : 3,
    "point" : {
      "longitude" : 1,
      "latitude" : 2,
      "height" : 3
    }
  }
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE distance(person.location, point($filter_person_location_distance_gt.point)) > $filter_person_location_distance_gt.distance
RETURN person {
	.name
} AS person
----

=== Filter spatial _distance gte_

.GraphQL-Query
[source,graphql]
----
{
  person(filter:{ location_distance_gte: { distance: 3, point: {longitude: 1, latitude:2, height: 3}}}){
    name
  }
}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_location_distance_gte" : {
    "distance" : 3,
    "point" : {
      "longitude" : 1,
      "latitude" : 2,
      "height" : 3
    }
  }
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE distance(person.location, point($filter_person_location_distance_gte.point)) >= $filter_person_location_distance_gte.distance
RETURN person {
	.name
} AS person
----

== Null Filtering

=== Filter _null_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { company: null }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE NOT (person)-[:WORKS_AT]->(:Company)
RETURN person {
	.name
} AS person
----

=== Filter _not null_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { company_not: null }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Joe"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE (person)-[:WORKS_AT]->(:Company)
RETURN person {
	.name
} AS person
----

== Logical Filter

=== Filter _AND_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { AND: [{ fun: true, name: "Jane"}]  }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_fun" : true,
  "filter_person_name" : "Jane"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE (person.fun = $filter_person_fun
	AND person.name = $filter_person_name)
RETURN person {
	.name
} AS person
----

'''

.GraphQL-Query
[source,graphql]
----
{ person(filter: { AND: [{ fun: true},{name: "Jane"}]  }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_AND1_fun" : true,
  "filter_person_AND2_name" : "Jane"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE (person.fun = $filter_person_AND1_fun
	AND person.name = $filter_person_AND2_name)
RETURN person {
	.name
} AS person
----

=== Filter _OR_

==== Multiple fields

.GraphQL-Query
[source,graphql]
----
{ person(filter: { OR: [{ fun: false, name_not: "Jane"}]  }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Joe"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_fun" : false,
  "filter_person_name_not" : "Jane"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE (person.fun = $filter_person_fun
	AND NOT (person.name = $filter_person_name_not))
RETURN person {
	.name
} AS person
----

==== Same field multiple values

.GraphQL-Query
[source,graphql]
----
{ person(filter: { OR: [{ name: "Jane"}, { name: "Joe"}]  }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Joe"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_OR1_name" : "Jane",
  "filter_person_OR2_name" : "Joe"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE (person.name = $filter_person_OR1_name
	OR person.name = $filter_person_OR2_name)
RETURN person {
	.name
} AS person
----

==== Multiple fields + array

.GraphQL-Query
[source,graphql]
----
{ person(filter: { OR: [{ fun: true},{name_in: ["Jane"]}]  }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_OR1_fun" : true,
  "filter_person_OR2_name_in" : [ "Jane" ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE (person.fun = $filter_person_OR1_fun
	OR person.name IN $filter_person_OR2_name_in)
RETURN person {
	.name
} AS person
----

=== Complex filter

.GraphQL-Query
[source,graphql]
----
{ person(filter: { OR: [{ AND: [{fun: true},{height:1.75}]},{name_in: ["Jane"]}]  }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_OR1_AND1_fun" : true,
  "filter_person_OR1_AND2_height" : 1.75,
  "filter_person_OR2_name_in" : [ "Jane" ]
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE ((person.fun = $filter_person_OR1_AND1_fun
	AND person.height = $filter_person_OR1_AND2_height)
	OR person.name IN $filter_person_OR2_name_in)
RETURN person {
	.name
} AS person
----

== Object filter

=== Filter object _some_ (cypher _ANY_)

.GraphQL-Query
[source,graphql]
----
{ p: company(filter: { employees_some : { name : "Jane" } }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "p" : [ {
    "name" : "ACME"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_p_Person_name" : "Jane"
}
----

.Cypher
[source,cypher]
----
MATCH (p:Company)
WHERE any(filter_p_Person_Cond IN [(p)<-[:WORKS_AT]-(filter_p_Person:Person) | filter_p_Person.name = $filter_p_Person_name]
WHERE filter_p_Person_Cond)
RETURN p {
	.name
} AS p
----

'''

.GraphQL-Query
[source,graphql]
----
{ p: company(filter: { employees_some : { name : "Jill" } }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "p" : [ {
    "name" : "ACME2"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_p_Person_name" : "Jill"
}
----

.Cypher
[source,cypher]
----
MATCH (p:Company)
WHERE any(filter_p_Person_Cond IN [(p)<-[:WORKS_AT]-(filter_p_Person:Person) | filter_p_Person.name = $filter_p_Person_name]
WHERE filter_p_Person_Cond)
RETURN p {
	.name
} AS p
----

=== Filter object _every_ (cypher _ALL_)

.GraphQL-Query
[source,graphql]
----
{ p: company(filter: { employees_every : { name : "Jill" } }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "p" : [ {
    "name" : "ACME2"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_p_Person_name" : "Jill"
}
----

.Cypher
[source,cypher]
----
MATCH (p:Company)
WHERE all(filter_p_Person_Cond IN [(p)<-[:WORKS_AT]-(filter_p_Person:Person) | filter_p_Person.name = $filter_p_Person_name]
WHERE filter_p_Person_Cond)
RETURN p {
	.name
} AS p
----

=== Filter object _none_ (cypher _NONE_)

.GraphQL-Query
[source,graphql]
----
{ p: company(filter: { employees_none : { name : "Jane" } }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "p" : [ {
    "name" : "ACME2"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_p_Person_name" : "Jane"
}
----

.Cypher
[source,cypher]
----
MATCH (p:Company)
WHERE none(filter_p_Person_Cond IN [(p)<-[:WORKS_AT]-(filter_p_Person:Person) | filter_p_Person.name = $filter_p_Person_name]
WHERE filter_p_Person_Cond)
RETURN p {
	.name
} AS p
----

'''

.GraphQL-Query
[source,graphql]
----
{ p: company(filter: { employees_none : { name : "Jill" } }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "p" : [ {
    "name" : "ACME"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_p_Person_name" : "Jill"
}
----

.Cypher
[source,cypher]
----
MATCH (p:Company)
WHERE none(filter_p_Person_Cond IN [(p)<-[:WORKS_AT]-(filter_p_Person:Person) | filter_p_Person.name = $filter_p_Person_name]
WHERE filter_p_Person_Cond)
RETURN p {
	.name
} AS p
----

=== Filter object _single_ (cypher _SINGLE_)

.GraphQL-Query
[source,graphql]
----
{ p: company(filter: { employees_single : { name : "Jill" } }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "p" : [ {
    "name" : "ACME2"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_p_Person_name" : "Jill"
}
----

.Cypher
[source,cypher]
----
MATCH (p:Company)
WHERE single(filter_p_Person_Cond IN [(p)<-[:WORKS_AT]-(filter_p_Person:Person) | filter_p_Person.name = $filter_p_Person_name]
WHERE filter_p_Person_Cond)
RETURN p {
	.name
} AS p
----

=== Filter object _null_

.GraphQL-Query
[source,graphql]
----
{ p: person(filter: { company : null }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "p" : [ ]
}
----

.Cypher Params
[source,json]
----
{}
----

.Cypher
[source,cypher]
----
MATCH (p:Person)
WHERE NOT (p)-[:WORKS_AT]->(:Company)
RETURN p {
	.name
} AS p
----

=== Filter object _not_null_

.GraphQL-Query
[source,graphql]
----
{ p: person(filter: { company_not : null }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "p" : [ {
    "name" : "Jane"
  }, {
    "name" : "Joe"
  }, {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{}
----

.Cypher
[source,cypher]
----
MATCH (p:Person)
WHERE (p)-[:WORKS_AT]->(:Company)
RETURN p {
	.name
} AS p
----

=== Cascaded filter object string _eq_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { company : { name : "ACME" } }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  }, {
    "name" : "Joe"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_Company_name" : "ACME"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE any(filter_person_Company_Cond IN [(person)-[:WORKS_AT]->(filter_person_Company:Company) | filter_person_Company.name = $filter_person_Company_name]
WHERE filter_person_Company_Cond)
RETURN person {
	.name
} AS person
----

=== Cascaded filter object _not_ string _eq_

.GraphQL-Query
[source,graphql]
----
{ person(filter: { company_not : { name : "ACME" } }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jill"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_Company_name" : "ACME"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE none(filter_person_Company_Cond IN [(person)-[:WORKS_AT]->(filter_person_Company:Company) | filter_person_Company.name = $filter_person_Company_name]
WHERE filter_person_Company_Cond)
RETURN person {
	.name
} AS person
----

=== Cascaded filter object string _in_

.GraphQL-Query
[source,graphql]
----
{ p: company(filter: { employees : { name_in : ["Jane","Joe"] } }) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "p" : [ {
    "name" : "ACME"
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_p_Person_name_in" : [ "Jane", "Joe" ]
}
----

.Cypher
[source,cypher]
----
MATCH (p:Company)
WHERE all(filter_p_Person_Cond IN [(p)<-[:WORKS_AT]-(filter_p_Person:Person) | filter_p_Person.name IN $filter_p_Person_name_in]
WHERE filter_p_Person_Cond)
RETURN p {
	.name
} AS p
----

=== Cascaded logical operator filter on object

.GraphQL-Query
[source,graphql]
----
{ p: company { employees(filter: { OR: [{ name: "Jane" },{name:"Joe"}]}) { name }}}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "p" : [ {
    "employees" : [ {
      "name" : "Joe"
    }, {
      "name" : "Jane"
    } ]
  }, {
    "employees" : [ ]
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_pEmployees_OR1_name" : "Jane",
  "filter_pEmployees_OR2_name" : "Joe"
}
----

.Cypher
[source,cypher]
----
MATCH (p:Company)
RETURN p {
	employees: [(p)<-[:WORKS_AT]-(pEmployees:Person) WHERE (pEmployees.name = $filter_pEmployees_OR1_name
	OR pEmployees.name = $filter_pEmployees_OR2_name) | pEmployees {
		.name
	}]
} AS p
----

== Use of Variables

=== Filter as variable

.GraphQL-Query
[source,graphql]
----
query filterQuery($filter: _PersonFilter) { person(filter: $filter) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Query variables
[source,json,request=true]
----
{
  "filter": {
    "name": "Jane",
    "company": {
      "name_ends_with": "ME"
    }
  }
}
----

.Cypher Params
[source,json]
----
{
  "filter_person_Company_name_ends_with" : "ME",
  "filter_person_name" : "Jane"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE (person.name = $filter_person_name
	AND any(filter_person_Company_Cond IN [(person)-[:WORKS_AT]->(filter_person_Company:Company) | filter_person_Company.name ENDS WITH $filter_person_Company_name_ends_with]
WHERE filter_person_Company_Cond))
RETURN person {
	.name
} AS person
----

=== Variable pass through

.GraphQL-Query
[source,graphql]
----
query filterQuery($name: String) { person(filter: {name : $name}) { name }}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "person" : [ {
    "name" : "Jane"
  } ]
}
----

.Query variables
[source,json,request=true]
----
{"name":"Jane"}
----

.Cypher Params
[source,json]
----
{
  "name" : "Jane"
}
----

.Cypher
[source,cypher]
----
MATCH (person:Person)
WHERE person.name = $name
RETURN person {
	.name
} AS person
----

== Aliasing

=== Filter with alias

.GraphQL-Query
[source,graphql]
----
{ p: company { employees(filter: { name: "Jane" }) { name }}}
----

.GraphQL-Response
[source,json,response=true]
----
{
  "p" : [ {
    "employees" : [ {
      "name" : "Jane"
    } ]
  }, {
    "employees" : [ ]
  } ]
}
----

.Cypher Params
[source,json]
----
{
  "filter_pEmployees_name" : "Jane"
}
----

.Cypher
[source,cypher]
----
MATCH (p:Company)
RETURN p {
	employees: [(p)<-[:WORKS_AT]-(pEmployees:Person) WHERE pEmployees.name = $filter_pEmployees_name | pEmployees {
		.name
	}]
} AS p
----
