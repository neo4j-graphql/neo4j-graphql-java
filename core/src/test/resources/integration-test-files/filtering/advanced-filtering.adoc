:toc:
:toclevels: 42

= Advanced Filtering

== ID Filtering

=== Setup

.Schema
[source,graphql,schema=true]
----
type Movie {
  property: ID
}
----

=== should find Movies IN strings

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: "RandomString1"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(
    where: {property_IN: ["RandomString1", "RandomString2", "RandomString3"]}
  ) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": [
    "RandomString1",
    "RandomString2",
    "RandomString3"
  ]
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property IN $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "movies": [
    {
      "property": "RandomString1"
    }
  ]
}
----

'''

=== should find Movies REGEX

.Configuration
[source,json,schema-config=true]
----
{
  "features": {
    "filters": {
      "ID": {
        "MATCHES": true
      }
    }
  }
}
----

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: "RandomString1RandomString1"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_MATCHES: "(?i)RandomString1.*"}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "(?i)RandomString1.*"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property =~ $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "movies": [
    {
      "property": "RandomString1RandomString1"
    }
  ]
}
----

'''

=== should find Movies CONTAINS string

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: "RandomString1RandomString1"})
 CREATE (:Movie {property: "RandomString1RandomString1"})
 CREATE (:Movie {property: "RandomString1RandomString1"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_CONTAINS: "RandomString1"}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "RandomString1"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property CONTAINS $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "property": "RandomString1RandomString1"
    },
    {
      "property": "RandomString1RandomString1"
    },
    {
      "property": "RandomString1RandomString1"
    }
  ]
}
----

'''

=== should find Movies STARTS_WITH string

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: "RandomString1RandomString1"})
 CREATE (:Movie {property: "RandomString1RandomString1"})
 CREATE (:Movie {property: "RandomString1RandomString1"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_STARTS_WITH: "RandomString1"}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "RandomString1"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property STARTS WITH $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "property": "RandomString1RandomString1"
    },
    {
      "property": "RandomString1RandomString1"
    },
    {
      "property": "RandomString1RandomString1"
    }
  ]
}
----

'''

=== should find Movies ENDS_WITH string

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: "RandomString1"})
 CREATE (:Movie {property: "RandomString2"})
 CREATE (:Movie {property: "RandomString1RandomString1"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_ENDS_WITH: "RandomString1"}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "RandomString1"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property ENDS WITH $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "property": "RandomString1"
    },
    {
      "property": "RandomString1RandomString1"
    }
  ]
}
----

'''

== String Filtering

=== Setup

.Schema
[source,graphql,schema=true]
----
type Movie {
  property: String
}
----

=== should find Movies IN strings

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: "RandomString1"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(
    where: {property_IN: ["RandomString1", "RandomString2", "RandomString3"]}
  ) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": [
    "RandomString1",
    "RandomString2",
    "RandomString3"
  ]
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property IN $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "movies": [
    {
      "property": "RandomString1"
    }
  ]
}
----

'''

=== should find Movies REGEX

.Configuration
[source,json,schema-config=true]
----
{
  "features": {
    "filters": {
      "String": {
        "MATCHES": true
      }
    }
  }
}
----

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: "RandomString1RandomString1"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_MATCHES: "(?i)RandomString1.*"}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "(?i)RandomString1.*"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property =~ $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "movies": [
    {
      "property": "RandomString1RandomString1"
    }
  ]
}
----

'''

=== should find Movies CONTAINS string

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: "RandomString1RandomString1"})
 CREATE (:Movie {property: "RandomString1RandomString1"})
 CREATE (:Movie {property: "RandomString1RandomString1"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_CONTAINS: "RandomString1"}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "RandomString1"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property CONTAINS $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "property": "RandomString1RandomString1"
    },
    {
      "property": "RandomString1RandomString1"
    },
    {
      "property": "RandomString1RandomString1"
    }
  ]
}
----

'''

=== should find Movies STARTS_WITH string

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: "RandomString1RandomString1"})
 CREATE (:Movie {property: "RandomString1RandomString1"})
 CREATE (:Movie {property: "RandomString1RandomString1"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_STARTS_WITH: "RandomString1"}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "RandomString1"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property STARTS WITH $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "property": "RandomString1RandomString1"
    },
    {
      "property": "RandomString1RandomString1"
    },
    {
      "property": "RandomString1RandomString1"
    }
  ]
}
----

'''

=== should find Movies ENDS_WITH string

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: "RandomString1"})
 CREATE (:Movie {property: "RandomString2"})
 CREATE (:Movie {property: "RandomString1RandomString1"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_ENDS_WITH: "RandomString1"}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "RandomString1"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property ENDS WITH $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "property": "RandomString1"
    },
    {
      "property": "RandomString1RandomString1"
    }
  ]
}
----

'''

== String Filtering

=== Setup

.Schema
[source,graphql,schema=true]
----
type Movie {
  title: String
}
----

.Configuration
[source,json,schema-config=true]
----
{
  "features": {
    "filters": {
      "String": {
        "LT": true,
        "GT": true,
        "LTE": true,
        "GTE": true
      }
    }
  }
}
----

=== should find Movies GT string

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {title: "The Animatrix"})
 CREATE (:Movie {title: "The Matrix"})
 CREATE (:Movie {title: "The Matrix Reloaded"})
 CREATE (:Movie {title: "The Matrix Revolutions"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {title_GT: "The Matrix"}) {
    title
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "The Matrix"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.title > $param0
RETURN this {
	.title
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "title": "The Matrix Reloaded"
    },
    {
      "title": "The Matrix Revolutions"
    }
  ]
}
----

'''

=== should find Movies LT string

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {title: "The Matrix"})
 CREATE (:Movie {title: "The Matrix Reloaded"})
 CREATE (:Movie {title: "The Matrix Revolutions"})
 CREATE (:Movie {title: "The Matrix Resurrections"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {title_LT: "The Matrix Revolutions"}) {
    title
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "The Matrix Revolutions"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.title < $param0
RETURN this {
	.title
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "title": "The Matrix"
    },
    {
      "title": "The Matrix Reloaded"
    },
    {
      "title": "The Matrix Resurrections"
    }
  ]
}
----

'''

=== should find Movies GTE string

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {title: "The Animatrix"})
 CREATE (:Movie {title: "The Matrix"})
 CREATE (:Movie {title: "The Matrix Reloaded"})
 CREATE (:Movie {title: "The Matrix Revolutions"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {title_GTE: "The Matrix"}) {
    title
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "The Matrix"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.title >= $param0
RETURN this {
	.title
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "title": "The Matrix"
    },
    {
      "title": "The Matrix Reloaded"
    },
    {
      "title": "The Matrix Revolutions"
    }
  ]
}
----

'''

=== should find Movies LTE string

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {title: "The Matrix"})
 CREATE (:Movie {title: "The Matrix Reloaded"})
 CREATE (:Movie {title: "The Matrix Revolutions"})
 CREATE (:Movie {title: "The Matrix Resurrections"})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {title_LTE: "The Matrix Revolutions"}) {
    title
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "The Matrix Revolutions"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.title <= $param0
RETURN this {
	.title
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "title": "The Matrix"
    },
    {
      "title": "The Matrix Reloaded"
    },
    {
      "title": "The Matrix Revolutions"
    },
    {
      "title": "The Matrix Resurrections"
    }
  ]
}
----

'''

== Int Filtering

=== Setup

.Schema
[source,graphql,schema=true]
----
type Movie {
  property: Int
}
----

=== should find Movies IN numbers

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: 3931})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_IN: [3931, 3813, 1484]}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": [
    3931,
    3813,
    1484
  ]
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property IN $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "movies": [
    {
      "property": 3931
    }
  ]
}
----

'''

=== should find Movies LT number

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: 1962})
 CREATE (:Movie {property: -1})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_LT: 0}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": 0
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property < $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "movies": [
    {
      "property": -1
    }
  ]
}
----

'''

=== should find Movies LTE number

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: 73})
 CREATE (:Movie {property: -1})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_LTE: 73}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": 73
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property <= $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "property": -1
    },
    {
      "property": 73
    }
  ]
}
----

'''

=== should find Movies GT number

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: 3996})
 CREATE (:Movie {property: 3997})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_GT: 3996}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": 3996
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property > $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "movies": [
    {
      "property": 3997
    }
  ]
}
----

'''

=== should find Movies GTE number

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: 926})
 CREATE (:Movie {property: 927})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_GTE: 926}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": 926
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property >= $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "property": 926
    },
    {
      "property": 927
    }
  ]
}
----

'''

== Float Filtering

=== Setup

.Schema
[source,graphql,schema=true]
----
type Movie {
  property: Float
}
----

=== should find Movies IN numbers

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: 3370.5})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_IN: [3370.5, 6229.5, 4440.5]}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": [
    3370.5,
    6229.5,
    4440.5
  ]
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property IN $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "movies": [
    {
      "property": 3370.5
    }
  ]
}
----

'''

=== should find Movies LT number

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: 3609.5})
 CREATE (:Movie {property: -1})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_LT: 0}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": 0
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property < $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "movies": [
    {
      "property": -1
    }
  ]
}
----

'''

=== should find Movies LTE number

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: 5016.5})
 CREATE (:Movie {property: -1})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_LTE: 5016.5}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": 5016.5
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property <= $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "property": 5016.5
    },
    {
      "property": -1
    }
  ]
}
----

'''

=== should find Movies GT number

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: 6420.5})
 CREATE (:Movie {property: 6421.5})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_GT: 6420.5}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": 6420.5
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property > $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "movies": [
    {
      "property": 6421.5
    }
  ]
}
----

'''

=== should find Movies GTE number

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: 4565.5})
 CREATE (:Movie {property: 4566.5})
----

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property_GTE: 4565.5}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": 4565.5
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property >= $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true,ignore-order]
----
{
  "movies": [
    {
      "property": 4565.5
    },
    {
      "property": 4566.5
    }
  ]
}
----

'''

== Boolean Filtering

=== Setup

.Schema
[source,graphql,schema=true]
----
type Movie {
  property: Boolean
}
----

.Test Data
[source,cypher,test-data=true]
----
CREATE (:Movie {property: false})
----

=== should find Movies equality equality

.GraphQL-Query
[source,graphql]
----
{
  movies(where: {property: false}) {
    property
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": false
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Movie)
WHERE this.property = $param0
RETURN this {
	.property
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "movies": [
    {
      "property": false
    }
  ]
}
----

'''

