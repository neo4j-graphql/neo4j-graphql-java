:toc:
:toclevels: 42

= undirected relationships

== query for an undirected relationship

.Schema
[source,graphql,schema=true]
----
type User {
  name: String!
  friends: [User!]! @relationship(type: "FRIENDS_WITH", direction: OUT)
}
----

.Test Data
[source,cypher,test-data=true]
----
CREATE (a:User {name: "Arthur"})
 CREATE (b:User {name: "Ford"})
 CREATE (a)-[:FRIENDS_WITH]->(b)
----

.GraphQL-Query
[source,graphql]
----
{
  users(where: {name: "Ford"}) {
    name
    friends: friends(directed: false) {
      name
    }
    directedFriends: friends(directed: true) {
      name
    }
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "Ford"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:User)
WHERE this.name = $param0
CALL {
	WITH this
	MATCH (this)-[friendsWith0:FRIENDS_WITH]-(user0:User)
	WITH user0 {
		.name
	} AS friends
	RETURN collect(friends) AS friends
}
CALL {
	WITH this
	MATCH (this)-[friendsWith1:FRIENDS_WITH]->(user1:User)
	WITH user1 {
		.name
	} AS directedFriends
	RETURN collect(directedFriends) AS directedFriends
}
RETURN this {
	.name,
	friends: friends,
	directedFriends: directedFriends
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "users": [
    {
      "name": "Ford",
      "friends": [
        {
          "name": "Arthur"
        }
      ],
      "directedFriends": []
    }
  ]
}
----

'''

