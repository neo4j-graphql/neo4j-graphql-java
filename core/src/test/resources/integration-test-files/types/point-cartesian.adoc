:toc:
:toclevels: 42

= CartesianPoint

== Setup

.Schema
[source,graphql,schema=true]
----
type Part {
  serial: String!
  location: CartesianPoint!
}
----

== enables query of a node with a cartesian point

.Test Data
[source,cypher,test-data=true]
----
CALL {
 CREATE (p:Part)
 SET p.serial = "bf92efbc-6c15-40ac-9cd5-8ab95fa4da90"
 SET p.location = point({x: 0.2800768264569342, y: 0.6105434170458466})
 RETURN p
 }

 RETURN p { .id, .location } AS p
----

.GraphQL-Query
[source,graphql]
----
query Parts($serial: String!) {
  parts(where: {serial: $serial}) {
    serial
    location {
      x
      y
      z
      crs
    }
  }
}
----

.GraphQL params input
[source,json,request=true]
----
{
  "serial": "bf92efbc-6c15-40ac-9cd5-8ab95fa4da90"
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "bf92efbc-6c15-40ac-9cd5-8ab95fa4da90"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Part)
WHERE this.serial = $param0
RETURN this {
	.serial,
	location: CASE WHEN this.location IS NOT NULL THEN {
		x: this.location.x,
		y: this.location.y,
		z: CASE WHEN this.location.srid = 9157 THEN this.location.z ELSE NULL END,
		crs: this.location.crs
	} ELSE NULL END
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "parts": [
    {
      "serial": "bf92efbc-6c15-40ac-9cd5-8ab95fa4da90",
      "location": {
        "x": 0.2800768264569342,
        "y": 0.6105434170458466,
        "z": null,
        "crs": "cartesian"
      }
    }
  ]
}
----

'''

== enables query of a node with a cartesian-3d point

.Test Data
[source,cypher,test-data=true]
----
CALL {
 CREATE (p:Part)
 SET p.serial = "c7715adc-9c9c-45ff-b4ed-6cb20bb044ad"
 SET p.location = point({x: 0.9446345162577927, y: 0.7858678111806512, z: 0.4248296618461609})
 RETURN p
 }

 RETURN p { .id, .location } AS p
----

.GraphQL-Query
[source,graphql]
----
query Parts($serial: String!) {
  parts(where: {serial: $serial}) {
    serial
    location {
      x
      y
      z
      crs
    }
  }
}
----

.GraphQL params input
[source,json,request=true]
----
{
  "serial": "c7715adc-9c9c-45ff-b4ed-6cb20bb044ad"
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "c7715adc-9c9c-45ff-b4ed-6cb20bb044ad"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Part)
WHERE this.serial = $param0
RETURN this {
	.serial,
	location: CASE WHEN this.location IS NOT NULL THEN {
		x: this.location.x,
		y: this.location.y,
		z: CASE WHEN this.location.srid = 9157 THEN this.location.z ELSE NULL END,
		crs: this.location.crs
	} ELSE NULL END
} AS this
----

.GraphQL-Response
[source,json,response=true]
----
{
  "parts": [
    {
      "serial": "c7715adc-9c9c-45ff-b4ed-6cb20bb044ad",
      "location": {
        "x": 0.9446345162577927,
        "y": 0.7858678111806512,
        "z": 0.4248296618461609,
        "crs": "cartesian-3d"
      }
    }
  ]
}
----

'''

