:toc:

= Cypher Aggregations Many

== Source schema

[source,graphql,schema=true]
----
type Movie {
  id: ID!
  title: String!
  imdbRating: Int!
  createdAt: DateTime!
}
----
== Min

.GraphQL-Query
[source,graphql]
----
{
  moviesAggregate {
    id {
      shortest
      longest
    }
    title {
      shortest
      longest
    }
    imdbRating {
      min
      max
      average
    }
    createdAt {
      min
      max
    }
  }
}
----

.Expected Cypher params
[source,json]
----
{}
----

.Expected Cypher output
[source,cypher]
----
CALL {
    MATCH (this:Movie)
    RETURN { shortest: min(this.id), longest: max(this.id) } AS var0
}
CALL {
    MATCH (this:Movie)
    WITH this
    ORDER BY size(this.title) DESC
    WITH collect(this.title) AS list
    RETURN { longest: head(list), shortest: last(list) } AS var1
}
CALL {
    MATCH (this:Movie)
    RETURN { min: min(this.imdbRating), max: max(this.imdbRating), average: avg(this.imdbRating) } AS var2
}
CALL {
    MATCH (this:Movie)
    RETURN { min: apoc.date.convertFormat(toString(min(this.createdAt)), "iso_zoned_date_time", "iso_offset_date_time"), max: apoc.date.convertFormat(toString(max(this.createdAt)), "iso_zoned_date_time", "iso_offset_date_time") } AS var3
}
RETURN { id: var0, title: var1, imdbRating: var2, createdAt: var3 }
----

'''

