:toc:

= https://github.com/neo4j/graphql/issues/3905

== Source schema

[source,graphql,schema=true]
----
type Query {
  paths: pathList! @cypher(statement: """
  WITH [[{entity_id:1, other_entity_id: 2}],[{entity_id: 2, other_entity_id:3},{entity_id:3, other_entity_id: 4}]] as paths
  RETURN {paths: paths} as result
  """, columnName: "result")
}

type pathList @query(read: false, aggregate: false) @mutation(operations: []) @subscription(events: []) {
  paths: [[pathLink]]
}

type pathLink @query(read: false, aggregate: false) @mutation(operations: []) @subscription(events: []) {
  entity_id: Int
  other_entity_id: Int
}
----

== custom Cypher query executes and translates as expected

.GraphQL-Query
[source,graphql]
----
{
  paths {
    paths {
      entity_id
      other_entity_id
    }
  }
}
----

.Expected Cypher params
[source,json]
----
{ }
----

.Expected Cypher output
[source,cypher]
----
CALL {
	WITH [[ {
		entity_id: 1,
		other_entity_id: 2
	}], [ {
		entity_id: 2,
		other_entity_id: 3
	}, {
		entity_id: 3,
		other_entity_id: 4
	}]] AS paths
	RETURN {
		paths: paths
	} AS result
}
WITH result AS this
RETURN this {
	.paths
} AS this
----

'''

