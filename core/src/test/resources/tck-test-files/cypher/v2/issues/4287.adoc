:toc:

= https://github.com/neo4j/graphql/issues/4287

== Source schema

[source,graphql,schema=true]
----
type Actor {
  name: String
  actedIn: [Production!]! @relationship(type: "ACTED_IN", properties: "actedIn", direction: OUT)
}

type actedIn @relationshipProperties {
  role: String
}

interface Production {
  title: String
}

type Movie implements Production {
  title: String
  runtime: Int
}

type Series implements Production {
  title: String
  episodes: Int
}
----
== filter by logical operator on interface connection

.GraphQL-Query
[source,graphql]
----
{
  actors {
    actedInConnection(
      where: {OR: [{node: {title: "something"}}, {node: {title: "whatever"}}]}
    ) {
      edges {
        node {
          __typename
          title
        }
      }
    }
  }
}
----

.Expected Cypher params
[source,json]
----
{
  "param0": "something",
  "param1": "whatever",
  "param2": "something",
  "param3": "whatever"
}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Actor)
CALL {
    WITH this
    CALL {
        WITH this
        MATCH (this)-[this0:ACTED_IN]->(this1:Movie)
        WHERE (this1.title = $param0 OR this1.title = $param1)
        WITH { node: { __resolveType: "Movie", __id: id(this1), title: this1.title } } AS edge
        RETURN edge
        UNION
        WITH this
        MATCH (this)-[this2:ACTED_IN]->(this3:Series)
        WHERE (this3.title = $param2 OR this3.title = $param3)
        WITH { node: { __resolveType: "Series", __id: id(this3), title: this3.title } } AS edge
        RETURN edge
    }
    WITH collect(edge) AS edges
    WITH edges, size(edges) AS totalCount
    RETURN { edges: edges, totalCount: totalCount } AS var4
}
RETURN this { actedInConnection: var4 } AS this
----

'''

