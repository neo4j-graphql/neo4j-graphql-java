// This file was generated by the Test-Case extractor of neo4j-graphql
:toc:
:toclevels: 42

= Undirected relationships

== query with directed and undirected relationships

.Schema
[source,graphql,schema=true]
----
type User {
  name: String!
  friends: [User!]! @relationship(type: "FRIENDS_WITH", direction: OUT)
}
----

.GraphQL-Query
[source,graphql,request=true]
----
{
  users {
    name
    friends: friends(directed: false) {
      name
    }
    directedFriends: friends {
      name
    }
  }
}
----

.Expected Cypher params
[source,json]
----
{}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:User)
CALL {
    WITH this
    MATCH (this)-[this0:FRIENDS_WITH]-(this1:User)
    WITH this1 { .name } AS this1
    RETURN collect(this1) AS var2
}
CALL {
    WITH this
    MATCH (this)-[this3:FRIENDS_WITH]->(this4:User)
    WITH this4 { .name } AS this4
    RETURN collect(this4) AS var5
}
RETURN this { .name, friends: var2, directedFriends: var5 } AS this
----

== undirected with unions

.Schema
[source,graphql,schema=true]
----
union Content = Blog | Post

type Blog {
  title: String
  posts: [Post!]! @relationship(type: "HAS_POST", direction: OUT)
}

type Post {
  content: String
}

type User {
  name: String
  content: [Content!]! @relationship(type: "HAS_CONTENT", direction: OUT)
}
----

.GraphQL-Query
[source,graphql,request=true]
----
query Users {
  users {
    content(directed: false) {
      ... on Blog {
        title
      }
      ... on Post {
        content
      }
    }
  }
}
----

.Expected Cypher params
[source,json]
----
{}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:User)
CALL {
    WITH this
    CALL {
        WITH *
        MATCH (this)-[this0:HAS_CONTENT]-(this1:Blog)
        WITH this1 { .title, __typename: "Blog", __id: toString(id(this1)) } AS this1
        RETURN this1 AS var2
        UNION
        WITH *
        MATCH (this)-[this3:HAS_CONTENT]-(this4:Post)
        WITH this4 { .content, __typename: "Post", __id: toString(id(this4)) } AS this4
        RETURN this4 AS var2
    }
    WITH var2
    RETURN collect(var2) AS var2
}
RETURN this { content: var2 } AS this
----

== undirected with interfaces

.Schema
[source,graphql,schema=true]
----
interface Production {
  title: String!
  actors: [Actor!]!
}

type Movie implements Production {
  title: String!
  actors: [Actor!]! @relationship(type: "ACTED_IN", direction: IN, properties: "ActedIn")
  runtime: Int!
}

type Series implements Production {
  title: String!
  actors: [Actor!]! @relationship(type: "ACTED_IN", direction: IN, properties: "ActedIn")
  episodes: Int!
}

type ActedIn @relationshipProperties {
  role: String!
}

type Actor {
  name: String!
  actedIn: [Production!]! @relationship(type: "ACTED_IN", direction: OUT, properties: "ActedIn")
}
----

.GraphQL-Query
[source,graphql,request=true]
----
query Actors {
  actors {
    actedIn(directed: false) {
      title
    }
  }
}
----

.Expected Cypher params
[source,json]
----
{}
----

.Expected Cypher output
[source,cypher]
----
MATCH (this:Actor)
CALL {
    WITH this
    CALL {
        WITH *
        MATCH (this)-[this0:ACTED_IN]-(this1:Movie)
        WITH this1 { .title, __typename: "Movie", __id: toString(id(this1)) } AS this1
        RETURN this1 AS var2
        UNION
        WITH *
        MATCH (this)-[this3:ACTED_IN]-(this4:Series)
        WITH this4 { .title, __typename: "Series", __id: toString(id(this4)) } AS this4
        RETURN this4 AS var2
    }
    WITH var2
    RETURN collect(var2) AS var2
}
RETURN this { actedIn: var2 } AS this
----
