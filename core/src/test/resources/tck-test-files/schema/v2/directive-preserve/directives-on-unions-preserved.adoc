:toc:

= Directive-preserve -> Directives on unions preserved

== Source schema

[source,graphql,schema=true]
----
union Content = Blog | Post

type Blog {
  title: String
  posts: [Post!]! @relationship(type: "HAS_POST", direction: OUT)
}

type Post {
  content: String @deprecated(reason: "Do not use post.content")
}

type User {
  name: String
  content: [Content!]! @relationship(type: "HAS_CONTENT", direction: OUT) @deprecated(reason: "Do not use user.content")
}
----

== Augmented schema

.Augmented Schema
[source,graphql]
----
schema {
  query: Query
  mutation: Mutation
}

union Content = Blog | Post

type Blog {
  posts(directed: Boolean = true, options: PostOptions, where: PostWhere): [Post!]!
  postsAggregate(directed: Boolean = true, where: PostWhere): BlogPostPostsAggregationSelection
  postsConnection(after: String, directed: Boolean = true, first: Int, sort: [BlogPostsConnectionSort!], where: BlogPostsConnectionWhere): BlogPostsConnection!
  title: String
}

type BlogAggregateSelection {
  count: Int!
  title: StringAggregateSelectionNullable!
}

type BlogEdge {
  cursor: String!
  node: Blog!
}

type BlogPostPostsAggregationSelection {
  count: Int!
  node: BlogPostPostsNodeAggregateSelection
}

type BlogPostPostsNodeAggregateSelection {
  content: StringAggregateSelectionNullable!
}

type BlogPostsConnection {
  edges: [BlogPostsRelationship!]!
  pageInfo: PageInfo!
  totalCount: Int!
}

type BlogPostsRelationship {
  cursor: String!
  node: Post!
}

type BlogsConnection {
  edges: [BlogEdge!]!
  pageInfo: PageInfo!
  totalCount: Int!
}

type CreateBlogsMutationResponse {
  blogs: [Blog!]!
  info: CreateInfo!
}

"Information about the number of nodes and relationships created during a create mutation"
type CreateInfo {
  bookmark: String @deprecated(reason : "This field has been deprecated because bookmarks are now handled by the driver.")
  nodesCreated: Int!
  relationshipsCreated: Int!
}

type CreatePostsMutationResponse {
  info: CreateInfo!
  posts: [Post!]!
}

type CreateUsersMutationResponse {
  info: CreateInfo!
  users: [User!]!
}

"Information about the number of nodes and relationships deleted during a delete mutation"
type DeleteInfo {
  bookmark: String @deprecated(reason : "This field has been deprecated because bookmarks are now handled by the driver.")
  nodesDeleted: Int!
  relationshipsDeleted: Int!
}

type Mutation {
  createBlogs(input: [BlogCreateInput!]!): CreateBlogsMutationResponse!
  createPosts(input: [PostCreateInput!]!): CreatePostsMutationResponse!
  createUsers(input: [UserCreateInput!]!): CreateUsersMutationResponse!
  deleteBlogs(delete: BlogDeleteInput, where: BlogWhere): DeleteInfo!
  deletePosts(where: PostWhere): DeleteInfo!
  deleteUsers(delete: UserDeleteInput, where: UserWhere): DeleteInfo!
  updateBlogs(connect: BlogConnectInput, create: BlogRelationInput, delete: BlogDeleteInput, disconnect: BlogDisconnectInput, update: BlogUpdateInput, where: BlogWhere): UpdateBlogsMutationResponse!
  updatePosts(update: PostUpdateInput, where: PostWhere): UpdatePostsMutationResponse!
  updateUsers(connect: UserConnectInput, create: UserRelationInput, delete: UserDeleteInput, disconnect: UserDisconnectInput, update: UserUpdateInput, where: UserWhere): UpdateUsersMutationResponse!
}

"Pagination information (Relay)"
type PageInfo {
  endCursor: String
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
  startCursor: String
}

type Post {
  content: String @deprecated(reason : "Do not use post.content")
}

type PostAggregateSelection {
  content: StringAggregateSelectionNullable!
  count: Int!
}

type PostEdge {
  cursor: String!
  node: Post!
}

type PostsConnection {
  edges: [PostEdge!]!
  pageInfo: PageInfo!
  totalCount: Int!
}

type Query {
  blogs(options: BlogOptions, where: BlogWhere): [Blog!]!
  blogsAggregate(where: BlogWhere): BlogAggregateSelection!
  blogsConnection(after: String, first: Int, sort: [BlogSort], where: BlogWhere): BlogsConnection!
  posts(options: PostOptions, where: PostWhere): [Post!]!
  postsAggregate(where: PostWhere): PostAggregateSelection!
  postsConnection(after: String, first: Int, sort: [PostSort], where: PostWhere): PostsConnection!
  users(options: UserOptions, where: UserWhere): [User!]!
  usersAggregate(where: UserWhere): UserAggregateSelection!
  usersConnection(after: String, first: Int, sort: [UserSort], where: UserWhere): UsersConnection!
}

type StringAggregateSelectionNullable {
  longest: String
  shortest: String
}

type UpdateBlogsMutationResponse {
  blogs: [Blog!]!
  info: UpdateInfo!
}

"Information about the number of nodes and relationships created and deleted during an update mutation"
type UpdateInfo {
  bookmark: String @deprecated(reason : "This field has been deprecated because bookmarks are now handled by the driver.")
  nodesCreated: Int!
  nodesDeleted: Int!
  relationshipsCreated: Int!
  relationshipsDeleted: Int!
}

type UpdatePostsMutationResponse {
  info: UpdateInfo!
  posts: [Post!]!
}

type UpdateUsersMutationResponse {
  info: UpdateInfo!
  users: [User!]!
}

type User {
  content(directed: Boolean = true, options: QueryOptions, where: ContentWhere): [Content!]! @deprecated(reason : "Do not use user.content")
  contentConnection(after: String, directed: Boolean = true, first: Int, where: UserContentConnectionWhere): UserContentConnection! @deprecated(reason : "Do not use user.content")
  name: String
}

type UserAggregateSelection {
  count: Int!
  name: StringAggregateSelectionNullable!
}

type UserContentConnection {
  edges: [UserContentRelationship!]!
  pageInfo: PageInfo!
  totalCount: Int!
}

type UserContentRelationship {
  cursor: String!
  node: Content!
}

type UserEdge {
  cursor: String!
  node: User!
}

type UsersConnection {
  edges: [UserEdge!]!
  pageInfo: PageInfo!
  totalCount: Int!
}

"An enum for sorting in either ascending or descending order."
enum SortDirection {
  "Sort by field values in ascending order."
  ASC
  "Sort by field values in descending order."
  DESC
}

input BlogConnectInput {
  posts: [BlogPostsConnectFieldInput!]
}

input BlogConnectWhere {
  node: BlogWhere!
}

input BlogCreateInput {
  posts: BlogPostsFieldInput
  title: String
}

input BlogDeleteInput {
  posts: [BlogPostsDeleteFieldInput!]
}

input BlogDisconnectInput {
  posts: [BlogPostsDisconnectFieldInput!]
}

input BlogOptions {
  limit: Int
  offset: Int
  "Specify one or more BlogSort objects to sort Blogs by. The sorts will be applied in the order in which they are arranged in the array."
  sort: [BlogSort!]
}

input BlogPostsAggregateInput {
  AND: [BlogPostsAggregateInput!]
  NOT: BlogPostsAggregateInput
  OR: [BlogPostsAggregateInput!]
  count: Int
  count_GT: Int
  count_GTE: Int
  count_LT: Int
  count_LTE: Int
  node: BlogPostsNodeAggregationWhereInput
}

input BlogPostsConnectFieldInput {
  "Whether or not to overwrite any matching relationship with the new properties."
  overwrite: Boolean! = true
  where: PostConnectWhere
}

input BlogPostsConnectionSort {
  node: PostSort
}

input BlogPostsConnectionWhere {
  AND: [BlogPostsConnectionWhere!]
  NOT: BlogPostsConnectionWhere
  OR: [BlogPostsConnectionWhere!]
  node: PostWhere
  node_NOT: PostWhere @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
}

input BlogPostsCreateFieldInput {
  node: PostCreateInput!
}

input BlogPostsDeleteFieldInput {
  where: BlogPostsConnectionWhere
}

input BlogPostsDisconnectFieldInput {
  where: BlogPostsConnectionWhere
}

input BlogPostsFieldInput {
  connect: [BlogPostsConnectFieldInput!]
  create: [BlogPostsCreateFieldInput!]
}

input BlogPostsNodeAggregationWhereInput {
  AND: [BlogPostsNodeAggregationWhereInput!]
  NOT: BlogPostsNodeAggregationWhereInput
  OR: [BlogPostsNodeAggregationWhereInput!]
  content_AVERAGE_EQUAL: Float @deprecated(reason : "Do not use post.content")
  content_AVERAGE_GT: Float @deprecated(reason : "Do not use post.content")
  content_AVERAGE_GTE: Float @deprecated(reason : "Do not use post.content")
  content_AVERAGE_LENGTH_EQUAL: Float @deprecated(reason : "Do not use post.content")
  content_AVERAGE_LENGTH_GT: Float @deprecated(reason : "Do not use post.content")
  content_AVERAGE_LENGTH_GTE: Float @deprecated(reason : "Do not use post.content")
  content_AVERAGE_LENGTH_LT: Float @deprecated(reason : "Do not use post.content")
  content_AVERAGE_LENGTH_LTE: Float @deprecated(reason : "Do not use post.content")
  content_AVERAGE_LT: Float @deprecated(reason : "Do not use post.content")
  content_AVERAGE_LTE: Float @deprecated(reason : "Do not use post.content")
  content_EQUAL: String @deprecated(reason : "Do not use post.content")
  content_GT: Int @deprecated(reason : "Do not use post.content")
  content_GTE: Int @deprecated(reason : "Do not use post.content")
  content_LONGEST_EQUAL: Int @deprecated(reason : "Do not use post.content")
  content_LONGEST_GT: Int @deprecated(reason : "Do not use post.content")
  content_LONGEST_GTE: Int @deprecated(reason : "Do not use post.content")
  content_LONGEST_LENGTH_EQUAL: Int @deprecated(reason : "Do not use post.content")
  content_LONGEST_LENGTH_GT: Int @deprecated(reason : "Do not use post.content")
  content_LONGEST_LENGTH_GTE: Int @deprecated(reason : "Do not use post.content")
  content_LONGEST_LENGTH_LT: Int @deprecated(reason : "Do not use post.content")
  content_LONGEST_LENGTH_LTE: Int @deprecated(reason : "Do not use post.content")
  content_LONGEST_LT: Int @deprecated(reason : "Do not use post.content")
  content_LONGEST_LTE: Int @deprecated(reason : "Do not use post.content")
  content_LT: Int @deprecated(reason : "Do not use post.content")
  content_LTE: Int @deprecated(reason : "Do not use post.content")
  content_SHORTEST_EQUAL: Int @deprecated(reason : "Do not use post.content")
  content_SHORTEST_GT: Int @deprecated(reason : "Do not use post.content")
  content_SHORTEST_GTE: Int @deprecated(reason : "Do not use post.content")
  content_SHORTEST_LENGTH_EQUAL: Int @deprecated(reason : "Do not use post.content")
  content_SHORTEST_LENGTH_GT: Int @deprecated(reason : "Do not use post.content")
  content_SHORTEST_LENGTH_GTE: Int @deprecated(reason : "Do not use post.content")
  content_SHORTEST_LENGTH_LT: Int @deprecated(reason : "Do not use post.content")
  content_SHORTEST_LENGTH_LTE: Int @deprecated(reason : "Do not use post.content")
  content_SHORTEST_LT: Int @deprecated(reason : "Do not use post.content")
  content_SHORTEST_LTE: Int @deprecated(reason : "Do not use post.content")
}

input BlogPostsUpdateConnectionInput {
  node: PostUpdateInput
}

input BlogPostsUpdateFieldInput {
  connect: [BlogPostsConnectFieldInput!]
  create: [BlogPostsCreateFieldInput!]
  delete: [BlogPostsDeleteFieldInput!]
  disconnect: [BlogPostsDisconnectFieldInput!]
  update: BlogPostsUpdateConnectionInput
  where: BlogPostsConnectionWhere
}

input BlogRelationInput {
  posts: [BlogPostsCreateFieldInput!]
}

"Fields to sort Blogs by. The order in which sorts are applied is not guaranteed when specifying many fields in one BlogSort object."
input BlogSort {
  title: SortDirection
}

input BlogUpdateInput {
  posts: [BlogPostsUpdateFieldInput!]
  title: String
}

input BlogWhere {
  AND: [BlogWhere!]
  NOT: BlogWhere
  OR: [BlogWhere!]
  posts: PostWhere @deprecated(reason : "Use `posts_SOME` instead.")
  postsAggregate: BlogPostsAggregateInput
  postsConnection: BlogPostsConnectionWhere @deprecated(reason : "Use `postsConnection_SOME` instead.")
  "Return Blogs where all of the related BlogPostsConnections match this filter"
  postsConnection_ALL: BlogPostsConnectionWhere
  "Return Blogs where none of the related BlogPostsConnections match this filter"
  postsConnection_NONE: BlogPostsConnectionWhere
  postsConnection_NOT: BlogPostsConnectionWhere @deprecated(reason : "Use `postsConnection_NONE` instead.")
  "Return Blogs where one of the related BlogPostsConnections match this filter"
  postsConnection_SINGLE: BlogPostsConnectionWhere
  "Return Blogs where some of the related BlogPostsConnections match this filter"
  postsConnection_SOME: BlogPostsConnectionWhere
  "Return Blogs where all of the related Posts match this filter"
  posts_ALL: PostWhere
  "Return Blogs where none of the related Posts match this filter"
  posts_NONE: PostWhere
  posts_NOT: PostWhere @deprecated(reason : "Use `posts_NONE` instead.")
  "Return Blogs where one of the related Posts match this filter"
  posts_SINGLE: PostWhere
  "Return Blogs where some of the related Posts match this filter"
  posts_SOME: PostWhere
  title: String
  title_CONTAINS: String
  title_ENDS_WITH: String
  title_IN: [String]
  title_NOT: String @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
  title_NOT_CONTAINS: String @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
  title_NOT_ENDS_WITH: String @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
  title_NOT_IN: [String] @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
  title_NOT_STARTS_WITH: String @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
  title_STARTS_WITH: String
}

input ContentWhere {
  Blog: BlogWhere
  Post: PostWhere
}

input PostConnectWhere {
  node: PostWhere!
}

input PostCreateInput {
  content: String @deprecated(reason : "Do not use post.content")
}

input PostOptions {
  limit: Int
  offset: Int
  "Specify one or more PostSort objects to sort Posts by. The sorts will be applied in the order in which they are arranged in the array."
  sort: [PostSort!]
}

"Fields to sort Posts by. The order in which sorts are applied is not guaranteed when specifying many fields in one PostSort object."
input PostSort {
  content: SortDirection @deprecated(reason : "Do not use post.content")
}

input PostUpdateInput {
  content: String @deprecated(reason : "Do not use post.content")
}

input PostWhere {
  AND: [PostWhere!]
  NOT: PostWhere
  OR: [PostWhere!]
  content: String @deprecated(reason : "Do not use post.content")
  content_CONTAINS: String @deprecated(reason : "Do not use post.content")
  content_ENDS_WITH: String @deprecated(reason : "Do not use post.content")
  content_IN: [String] @deprecated(reason : "Do not use post.content")
  content_NOT: String @deprecated(reason : "Do not use post.content")
  content_NOT_CONTAINS: String @deprecated(reason : "Do not use post.content")
  content_NOT_ENDS_WITH: String @deprecated(reason : "Do not use post.content")
  content_NOT_IN: [String] @deprecated(reason : "Do not use post.content")
  content_NOT_STARTS_WITH: String @deprecated(reason : "Do not use post.content")
  content_STARTS_WITH: String @deprecated(reason : "Do not use post.content")
}

"Input type for options that can be specified on a query operation."
input QueryOptions {
  limit: Int
  offset: Int
}

input UserConnectInput {
  content: UserContentConnectInput @deprecated(reason : "Do not use user.content")
}

input UserContentBlogConnectFieldInput {
  connect: [BlogConnectInput!]
  where: BlogConnectWhere
}

input UserContentBlogConnectionWhere {
  AND: [UserContentBlogConnectionWhere!]
  NOT: UserContentBlogConnectionWhere
  OR: [UserContentBlogConnectionWhere!]
  node: BlogWhere
  node_NOT: BlogWhere @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
}

input UserContentBlogCreateFieldInput {
  node: BlogCreateInput!
}

input UserContentBlogDeleteFieldInput {
  delete: BlogDeleteInput
  where: UserContentBlogConnectionWhere
}

input UserContentBlogDisconnectFieldInput {
  disconnect: BlogDisconnectInput
  where: UserContentBlogConnectionWhere
}

input UserContentBlogFieldInput {
  connect: [UserContentBlogConnectFieldInput!]
  create: [UserContentBlogCreateFieldInput!]
}

input UserContentBlogUpdateConnectionInput {
  node: BlogUpdateInput
}

input UserContentBlogUpdateFieldInput {
  connect: [UserContentBlogConnectFieldInput!]
  create: [UserContentBlogCreateFieldInput!]
  delete: [UserContentBlogDeleteFieldInput!]
  disconnect: [UserContentBlogDisconnectFieldInput!]
  update: UserContentBlogUpdateConnectionInput
  where: UserContentBlogConnectionWhere
}

input UserContentConnectInput {
  Blog: [UserContentBlogConnectFieldInput!]
  Post: [UserContentPostConnectFieldInput!]
}

input UserContentConnectionWhere {
  Blog: UserContentBlogConnectionWhere
  Post: UserContentPostConnectionWhere
}

input UserContentCreateFieldInput {
  Blog: [UserContentBlogCreateFieldInput!]
  Post: [UserContentPostCreateFieldInput!]
}

input UserContentCreateInput {
  Blog: UserContentBlogFieldInput
  Post: UserContentPostFieldInput
}

input UserContentDeleteInput {
  Blog: [UserContentBlogDeleteFieldInput!]
  Post: [UserContentPostDeleteFieldInput!]
}

input UserContentDisconnectInput {
  Blog: [UserContentBlogDisconnectFieldInput!]
  Post: [UserContentPostDisconnectFieldInput!]
}

input UserContentPostConnectFieldInput {
  where: PostConnectWhere
}

input UserContentPostConnectionWhere {
  AND: [UserContentPostConnectionWhere!]
  NOT: UserContentPostConnectionWhere
  OR: [UserContentPostConnectionWhere!]
  node: PostWhere
  node_NOT: PostWhere @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
}

input UserContentPostCreateFieldInput {
  node: PostCreateInput!
}

input UserContentPostDeleteFieldInput {
  where: UserContentPostConnectionWhere
}

input UserContentPostDisconnectFieldInput {
  where: UserContentPostConnectionWhere
}

input UserContentPostFieldInput {
  connect: [UserContentPostConnectFieldInput!]
  create: [UserContentPostCreateFieldInput!]
}

input UserContentPostUpdateConnectionInput {
  node: PostUpdateInput
}

input UserContentPostUpdateFieldInput {
  connect: [UserContentPostConnectFieldInput!]
  create: [UserContentPostCreateFieldInput!]
  delete: [UserContentPostDeleteFieldInput!]
  disconnect: [UserContentPostDisconnectFieldInput!]
  update: UserContentPostUpdateConnectionInput
  where: UserContentPostConnectionWhere
}

input UserContentUpdateInput {
  Blog: [UserContentBlogUpdateFieldInput!]
  Post: [UserContentPostUpdateFieldInput!]
}

input UserCreateInput {
  content: UserContentCreateInput @deprecated(reason : "Do not use user.content")
  name: String
}

input UserDeleteInput {
  content: UserContentDeleteInput @deprecated(reason : "Do not use user.content")
}

input UserDisconnectInput {
  content: UserContentDisconnectInput @deprecated(reason : "Do not use user.content")
}

input UserOptions {
  limit: Int
  offset: Int
  "Specify one or more UserSort objects to sort Users by. The sorts will be applied in the order in which they are arranged in the array."
  sort: [UserSort!]
}

input UserRelationInput {
  content: UserContentCreateFieldInput @deprecated(reason : "Do not use user.content")
}

"Fields to sort Users by. The order in which sorts are applied is not guaranteed when specifying many fields in one UserSort object."
input UserSort {
  name: SortDirection
}

input UserUpdateInput {
  content: UserContentUpdateInput @deprecated(reason : "Do not use user.content")
  name: String
}

input UserWhere {
  AND: [UserWhere!]
  NOT: UserWhere
  OR: [UserWhere!]
  contentConnection: UserContentConnectionWhere @deprecated(reason : "Do not use user.content")
  "Return Users where all of the related UserContentConnections match this filter"
  contentConnection_ALL: UserContentConnectionWhere @deprecated(reason : "Do not use user.content")
  "Return Users where none of the related UserContentConnections match this filter"
  contentConnection_NONE: UserContentConnectionWhere @deprecated(reason : "Do not use user.content")
  contentConnection_NOT: UserContentConnectionWhere @deprecated(reason : "Do not use user.content")
  "Return Users where one of the related UserContentConnections match this filter"
  contentConnection_SINGLE: UserContentConnectionWhere @deprecated(reason : "Do not use user.content")
  "Return Users where some of the related UserContentConnections match this filter"
  contentConnection_SOME: UserContentConnectionWhere @deprecated(reason : "Do not use user.content")
  name: String
  name_CONTAINS: String
  name_ENDS_WITH: String
  name_IN: [String]
  name_NOT: String @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
  name_NOT_CONTAINS: String @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
  name_NOT_ENDS_WITH: String @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
  name_NOT_IN: [String] @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
  name_NOT_STARTS_WITH: String @deprecated(reason : "Negation filters will be deprecated, use the NOT operator to achieve the same behavior")
  name_STARTS_WITH: String
}

----

'''
