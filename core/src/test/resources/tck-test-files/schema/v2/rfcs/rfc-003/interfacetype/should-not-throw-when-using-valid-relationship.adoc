:toc:

= schema/rfc/003 -> InterfaceType -> should not throw when using valid relationship

== Source schema

[source,graphql,schema=true]
----
interface SourceInterface {
  targets: [Target!]! @declareRelationship
  target1: Target! @declareRelationship
  target2: Target @declareRelationship
}

type Source implements SourceInterface {
  id: ID @id @unique
  targets: [Target!]! @relationship(type: "HAS_TARGET", direction: OUT)
  target1: Target! @relationship(type: "HAS_TARGET", direction: OUT)
  target2: Target @relationship(type: "HAS_TARGET", direction: OUT)
}

type Target {
  id: ID @id @unique
}
----

== Augmented schema

.Augmented Schema
[source,graphql]
----
schema {
  query: Query
  mutation: Mutation
}

"""
Information about the number of nodes and relationships created during a create mutation
"""
type CreateInfo {
  nodesCreated: Int!
  relationshipsCreated: Int!
}

type CreateSourcesMutationResponse {
  info: CreateInfo!
  sources: [Source!]!
}

type CreateTargetsMutationResponse {
  info: CreateInfo!
  targets: [Target!]!
}

"""
Information about the number of nodes and relationships deleted during a delete mutation
"""
type DeleteInfo {
  nodesDeleted: Int!
  relationshipsDeleted: Int!
}

type IDAggregateSelection {
  longest: ID
  shortest: ID
}

type Mutation {
  createSources(input: [SourceCreateInput!]!): CreateSourcesMutationResponse!
  createTargets(input: [TargetCreateInput!]!): CreateTargetsMutationResponse!
  deleteSources(delete: SourceDeleteInput, where: SourceWhere): DeleteInfo!
  deleteTargets(where: TargetWhere): DeleteInfo!
  updateSources(connect: SourceConnectInput, connectOrCreate: SourceConnectOrCreateInput, create: SourceRelationInput, delete: SourceDeleteInput, disconnect: SourceDisconnectInput, update: SourceUpdateInput, where: SourceWhere): UpdateSourcesMutationResponse!
  updateTargets(update: TargetUpdateInput, where: TargetWhere): UpdateTargetsMutationResponse!
}

"""Pagination information (Relay)"""
type PageInfo {
  endCursor: String
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
  startCursor: String
}

type Query {
  sourceInterfaces(options: SourceInterfaceOptions, where: SourceInterfaceWhere): [SourceInterface!]!
  sourceInterfacesAggregate(where: SourceInterfaceWhere): SourceInterfaceAggregateSelection!
  sourceInterfacesConnection(after: String, first: Int, where: SourceInterfaceWhere): SourceInterfacesConnection!
  sources(options: SourceOptions, where: SourceWhere): [Source!]!
  sourcesAggregate(where: SourceWhere): SourceAggregateSelection!
  sourcesConnection(after: String, first: Int, sort: [SourceSort], where: SourceWhere): SourcesConnection!
  targets(options: TargetOptions, where: TargetWhere): [Target!]!
  targetsAggregate(where: TargetWhere): TargetAggregateSelection!
  targetsConnection(after: String, first: Int, sort: [TargetSort], where: TargetWhere): TargetsConnection!
}

"""An enum for sorting in either ascending or descending order."""
enum SortDirection {
  """Sort by field values in ascending order."""
  ASC
  """Sort by field values in descending order."""
  DESC
}

type Source implements SourceInterface {
  id: ID
  target1(directed: Boolean = true, options: TargetOptions, where: TargetWhere): Target!
  target1Aggregate(directed: Boolean = true, where: TargetWhere): SourceTargetTarget1AggregationSelection
  target1Connection(after: String, directed: Boolean = true, first: Int, sort: [SourceInterfaceTarget1ConnectionSort!], where: SourceInterfaceTarget1ConnectionWhere): SourceInterfaceTarget1Connection!
  target2(directed: Boolean = true, options: TargetOptions, where: TargetWhere): Target
  target2Aggregate(directed: Boolean = true, where: TargetWhere): SourceTargetTarget2AggregationSelection
  target2Connection(after: String, directed: Boolean = true, first: Int, sort: [SourceInterfaceTarget2ConnectionSort!], where: SourceInterfaceTarget2ConnectionWhere): SourceInterfaceTarget2Connection!
  targets(directed: Boolean = true, options: TargetOptions, where: TargetWhere): [Target!]!
  targetsAggregate(directed: Boolean = true, where: TargetWhere): SourceTargetTargetsAggregationSelection
  targetsConnection(after: String, directed: Boolean = true, first: Int, sort: [SourceInterfaceTargetsConnectionSort!], where: SourceInterfaceTargetsConnectionWhere): SourceInterfaceTargetsConnection!
}

type SourceAggregateSelection {
  count: Int!
  id: IDAggregateSelection!
}

input SourceConnectInput {
  target1: SourceTarget1ConnectFieldInput
  target2: SourceTarget2ConnectFieldInput
  targets: [SourceTargetsConnectFieldInput!]
}

input SourceConnectOrCreateInput {
  target1: SourceTarget1ConnectOrCreateFieldInput
  target2: SourceTarget2ConnectOrCreateFieldInput
  targets: [SourceTargetsConnectOrCreateFieldInput!]
}

input SourceCreateInput {
  target1: SourceTarget1FieldInput
  target2: SourceTarget2FieldInput
  targets: SourceTargetsFieldInput
}

input SourceDeleteInput {
  target1: SourceInterfaceTarget1DeleteFieldInput
  target2: SourceInterfaceTarget2DeleteFieldInput
  targets: [SourceInterfaceTargetsDeleteFieldInput!]
}

input SourceDisconnectInput {
  target1: SourceInterfaceTarget1DisconnectFieldInput
  target2: SourceInterfaceTarget2DisconnectFieldInput
  targets: [SourceInterfaceTargetsDisconnectFieldInput!]
}

type SourceEdge {
  cursor: String!
  node: Source!
}

interface SourceInterface {
  target1(options: TargetOptions, where: TargetWhere): Target!
  target1Connection(after: String, first: Int, sort: [SourceInterfaceTarget1ConnectionSort!], where: SourceInterfaceTarget1ConnectionWhere): SourceInterfaceTarget1Connection!
  target2(options: TargetOptions, where: TargetWhere): Target
  target2Connection(after: String, first: Int, sort: [SourceInterfaceTarget2ConnectionSort!], where: SourceInterfaceTarget2ConnectionWhere): SourceInterfaceTarget2Connection!
  targets(options: TargetOptions, where: TargetWhere): [Target!]!
  targetsConnection(after: String, first: Int, sort: [SourceInterfaceTargetsConnectionSort!], where: SourceInterfaceTargetsConnectionWhere): SourceInterfaceTargetsConnection!
}

type SourceInterfaceAggregateSelection {
  count: Int!
}

type SourceInterfaceEdge {
  cursor: String!
  node: SourceInterface!
}

enum SourceInterfaceImplementation {
  Source
}

input SourceInterfaceOptions {
  limit: Int
  offset: Int
}

input SourceInterfaceTarget1AggregateInput {
  AND: [SourceInterfaceTarget1AggregateInput!]
  NOT: SourceInterfaceTarget1AggregateInput
  OR: [SourceInterfaceTarget1AggregateInput!]
  count: Int
  count_GT: Int
  count_GTE: Int
  count_LT: Int
  count_LTE: Int
}

type SourceInterfaceTarget1Connection {
  edges: [SourceInterfaceTarget1Relationship!]!
  pageInfo: PageInfo!
  totalCount: Int!
}

input SourceInterfaceTarget1ConnectionSort {
  node: TargetSort
}

input SourceInterfaceTarget1ConnectionWhere {
  AND: [SourceInterfaceTarget1ConnectionWhere!]
  NOT: SourceInterfaceTarget1ConnectionWhere
  OR: [SourceInterfaceTarget1ConnectionWhere!]
  node: TargetWhere
}

input SourceInterfaceTarget1DeleteFieldInput {
  where: SourceInterfaceTarget1ConnectionWhere
}

input SourceInterfaceTarget1DisconnectFieldInput {
  where: SourceInterfaceTarget1ConnectionWhere
}

type SourceInterfaceTarget1Relationship {
  cursor: String!
  node: Target!
}

input SourceInterfaceTarget2AggregateInput {
  AND: [SourceInterfaceTarget2AggregateInput!]
  NOT: SourceInterfaceTarget2AggregateInput
  OR: [SourceInterfaceTarget2AggregateInput!]
  count: Int
  count_GT: Int
  count_GTE: Int
  count_LT: Int
  count_LTE: Int
}

type SourceInterfaceTarget2Connection {
  edges: [SourceInterfaceTarget2Relationship!]!
  pageInfo: PageInfo!
  totalCount: Int!
}

input SourceInterfaceTarget2ConnectionSort {
  node: TargetSort
}

input SourceInterfaceTarget2ConnectionWhere {
  AND: [SourceInterfaceTarget2ConnectionWhere!]
  NOT: SourceInterfaceTarget2ConnectionWhere
  OR: [SourceInterfaceTarget2ConnectionWhere!]
  node: TargetWhere
}

input SourceInterfaceTarget2DeleteFieldInput {
  where: SourceInterfaceTarget2ConnectionWhere
}

input SourceInterfaceTarget2DisconnectFieldInput {
  where: SourceInterfaceTarget2ConnectionWhere
}

type SourceInterfaceTarget2Relationship {
  cursor: String!
  node: Target!
}

input SourceInterfaceTargetsAggregateInput {
  AND: [SourceInterfaceTargetsAggregateInput!]
  NOT: SourceInterfaceTargetsAggregateInput
  OR: [SourceInterfaceTargetsAggregateInput!]
  count: Int
  count_GT: Int
  count_GTE: Int
  count_LT: Int
  count_LTE: Int
}

type SourceInterfaceTargetsConnection {
  edges: [SourceInterfaceTargetsRelationship!]!
  pageInfo: PageInfo!
  totalCount: Int!
}

input SourceInterfaceTargetsConnectionSort {
  node: TargetSort
}

input SourceInterfaceTargetsConnectionWhere {
  AND: [SourceInterfaceTargetsConnectionWhere!]
  NOT: SourceInterfaceTargetsConnectionWhere
  OR: [SourceInterfaceTargetsConnectionWhere!]
  node: TargetWhere
}

input SourceInterfaceTargetsDeleteFieldInput {
  where: SourceInterfaceTargetsConnectionWhere
}

input SourceInterfaceTargetsDisconnectFieldInput {
  where: SourceInterfaceTargetsConnectionWhere
}

type SourceInterfaceTargetsRelationship {
  cursor: String!
  node: Target!
}

input SourceInterfaceWhere {
  AND: [SourceInterfaceWhere!]
  NOT: SourceInterfaceWhere
  OR: [SourceInterfaceWhere!]
  target1: TargetWhere
  target1Aggregate: SourceInterfaceTarget1AggregateInput
  target1Connection: SourceInterfaceTarget1ConnectionWhere
  target1Connection_NOT: SourceInterfaceTarget1ConnectionWhere
  target1_NOT: TargetWhere
  target2: TargetWhere
  target2Aggregate: SourceInterfaceTarget2AggregateInput
  target2Connection: SourceInterfaceTarget2ConnectionWhere
  target2Connection_NOT: SourceInterfaceTarget2ConnectionWhere
  target2_NOT: TargetWhere
  targetsAggregate: SourceInterfaceTargetsAggregateInput
  """
  Return SourceInterfaces where all of the related SourceInterfaceTargetsConnections match this filter
  """
  targetsConnection_ALL: SourceInterfaceTargetsConnectionWhere
  """
  Return SourceInterfaces where none of the related SourceInterfaceTargetsConnections match this filter
  """
  targetsConnection_NONE: SourceInterfaceTargetsConnectionWhere
  """
  Return SourceInterfaces where one of the related SourceInterfaceTargetsConnections match this filter
  """
  targetsConnection_SINGLE: SourceInterfaceTargetsConnectionWhere
  """
  Return SourceInterfaces where some of the related SourceInterfaceTargetsConnections match this filter
  """
  targetsConnection_SOME: SourceInterfaceTargetsConnectionWhere
  """
  Return SourceInterfaces where all of the related Targets match this filter
  """
  targets_ALL: TargetWhere
  """
  Return SourceInterfaces where none of the related Targets match this filter
  """
  targets_NONE: TargetWhere
  """
  Return SourceInterfaces where one of the related Targets match this filter
  """
  targets_SINGLE: TargetWhere
  """
  Return SourceInterfaces where some of the related Targets match this filter
  """
  targets_SOME: TargetWhere
  typename_IN: [SourceInterfaceImplementation!]
}

type SourceInterfacesConnection {
  edges: [SourceInterfaceEdge!]!
  pageInfo: PageInfo!
  totalCount: Int!
}

input SourceOptions {
  limit: Int
  offset: Int
  """
  Specify one or more SourceSort objects to sort Sources by. The sorts will be applied in the order in which they are arranged in the array.
  """
  sort: [SourceSort!]
}

input SourceRelationInput {
  target1: SourceTarget1CreateFieldInput
  target2: SourceTarget2CreateFieldInput
  targets: [SourceTargetsCreateFieldInput!]
}

"""
Fields to sort Sources by. The order in which sorts are applied is not guaranteed when specifying many fields in one SourceSort object.
"""
input SourceSort {
  id: SortDirection
}

input SourceTarget1AggregateInput {
  AND: [SourceTarget1AggregateInput!]
  NOT: SourceTarget1AggregateInput
  OR: [SourceTarget1AggregateInput!]
  count: Int
  count_GT: Int
  count_GTE: Int
  count_LT: Int
  count_LTE: Int
}

input SourceTarget1ConnectFieldInput {
  """
  Whether or not to overwrite any matching relationship with the new properties.
  """
  overwrite: Boolean! = true
  where: TargetConnectWhere
}

input SourceTarget1ConnectOrCreateFieldInput {
  onCreate: SourceTarget1ConnectOrCreateFieldInputOnCreate!
  where: TargetConnectOrCreateWhere!
}

input SourceTarget1ConnectOrCreateFieldInputOnCreate {
  node: TargetOnCreateInput!
}

input SourceTarget1CreateFieldInput {
  node: TargetCreateInput!
}

input SourceTarget1FieldInput {
  connect: SourceTarget1ConnectFieldInput
  connectOrCreate: SourceTarget1ConnectOrCreateFieldInput
  create: SourceTarget1CreateFieldInput
}

input SourceTarget1UpdateConnectionInput {
  node: TargetUpdateInput
}

input SourceTarget1UpdateFieldInput {
  connect: SourceTarget1ConnectFieldInput
  connectOrCreate: SourceTarget1ConnectOrCreateFieldInput
  create: SourceTarget1CreateFieldInput
  delete: SourceInterfaceTarget1DeleteFieldInput
  disconnect: SourceInterfaceTarget1DisconnectFieldInput
  update: SourceTarget1UpdateConnectionInput
  where: SourceInterfaceTarget1ConnectionWhere
}

input SourceTarget2AggregateInput {
  AND: [SourceTarget2AggregateInput!]
  NOT: SourceTarget2AggregateInput
  OR: [SourceTarget2AggregateInput!]
  count: Int
  count_GT: Int
  count_GTE: Int
  count_LT: Int
  count_LTE: Int
}

input SourceTarget2ConnectFieldInput {
  """
  Whether or not to overwrite any matching relationship with the new properties.
  """
  overwrite: Boolean! = true
  where: TargetConnectWhere
}

input SourceTarget2ConnectOrCreateFieldInput {
  onCreate: SourceTarget2ConnectOrCreateFieldInputOnCreate!
  where: TargetConnectOrCreateWhere!
}

input SourceTarget2ConnectOrCreateFieldInputOnCreate {
  node: TargetOnCreateInput!
}

input SourceTarget2CreateFieldInput {
  node: TargetCreateInput!
}

input SourceTarget2FieldInput {
  connect: SourceTarget2ConnectFieldInput
  connectOrCreate: SourceTarget2ConnectOrCreateFieldInput
  create: SourceTarget2CreateFieldInput
}

input SourceTarget2UpdateConnectionInput {
  node: TargetUpdateInput
}

input SourceTarget2UpdateFieldInput {
  connect: SourceTarget2ConnectFieldInput
  connectOrCreate: SourceTarget2ConnectOrCreateFieldInput
  create: SourceTarget2CreateFieldInput
  delete: SourceInterfaceTarget2DeleteFieldInput
  disconnect: SourceInterfaceTarget2DisconnectFieldInput
  update: SourceTarget2UpdateConnectionInput
  where: SourceInterfaceTarget2ConnectionWhere
}

type SourceTargetTarget1AggregationSelection {
  count: Int!
  node: SourceTargetTarget1NodeAggregateSelection
}

type SourceTargetTarget1NodeAggregateSelection {
  id: IDAggregateSelection!
}

type SourceTargetTarget2AggregationSelection {
  count: Int!
  node: SourceTargetTarget2NodeAggregateSelection
}

type SourceTargetTarget2NodeAggregateSelection {
  id: IDAggregateSelection!
}

type SourceTargetTargetsAggregationSelection {
  count: Int!
  node: SourceTargetTargetsNodeAggregateSelection
}

type SourceTargetTargetsNodeAggregateSelection {
  id: IDAggregateSelection!
}

input SourceTargetsAggregateInput {
  AND: [SourceTargetsAggregateInput!]
  NOT: SourceTargetsAggregateInput
  OR: [SourceTargetsAggregateInput!]
  count: Int
  count_GT: Int
  count_GTE: Int
  count_LT: Int
  count_LTE: Int
}

input SourceTargetsConnectFieldInput {
  """
  Whether or not to overwrite any matching relationship with the new properties.
  """
  overwrite: Boolean! = true
  where: TargetConnectWhere
}

input SourceTargetsConnectOrCreateFieldInput {
  onCreate: SourceTargetsConnectOrCreateFieldInputOnCreate!
  where: TargetConnectOrCreateWhere!
}

input SourceTargetsConnectOrCreateFieldInputOnCreate {
  node: TargetOnCreateInput!
}

input SourceTargetsCreateFieldInput {
  node: TargetCreateInput!
}

input SourceTargetsFieldInput {
  connect: [SourceTargetsConnectFieldInput!]
  connectOrCreate: [SourceTargetsConnectOrCreateFieldInput!]
  create: [SourceTargetsCreateFieldInput!]
}

input SourceTargetsUpdateConnectionInput {
  node: TargetUpdateInput
}

input SourceTargetsUpdateFieldInput {
  connect: [SourceTargetsConnectFieldInput!]
  connectOrCreate: [SourceTargetsConnectOrCreateFieldInput!]
  create: [SourceTargetsCreateFieldInput!]
  delete: [SourceInterfaceTargetsDeleteFieldInput!]
  disconnect: [SourceInterfaceTargetsDisconnectFieldInput!]
  update: SourceTargetsUpdateConnectionInput
  where: SourceInterfaceTargetsConnectionWhere
}

input SourceUpdateInput {
  target1: SourceTarget1UpdateFieldInput
  target2: SourceTarget2UpdateFieldInput
  targets: [SourceTargetsUpdateFieldInput!]
}

input SourceWhere {
  AND: [SourceWhere!]
  NOT: SourceWhere
  OR: [SourceWhere!]
  id: ID
  id_CONTAINS: ID
  id_ENDS_WITH: ID
  id_IN: [ID]
  id_STARTS_WITH: ID
  target1: TargetWhere
  target1Aggregate: SourceTarget1AggregateInput
  target1Connection: SourceInterfaceTarget1ConnectionWhere
  target1Connection_NOT: SourceInterfaceTarget1ConnectionWhere
  target1_NOT: TargetWhere
  target2: TargetWhere
  target2Aggregate: SourceTarget2AggregateInput
  target2Connection: SourceInterfaceTarget2ConnectionWhere
  target2Connection_NOT: SourceInterfaceTarget2ConnectionWhere
  target2_NOT: TargetWhere
  targetsAggregate: SourceTargetsAggregateInput
  """
  Return Sources where all of the related SourceInterfaceTargetsConnections match this filter
  """
  targetsConnection_ALL: SourceInterfaceTargetsConnectionWhere
  """
  Return Sources where none of the related SourceInterfaceTargetsConnections match this filter
  """
  targetsConnection_NONE: SourceInterfaceTargetsConnectionWhere
  """
  Return Sources where one of the related SourceInterfaceTargetsConnections match this filter
  """
  targetsConnection_SINGLE: SourceInterfaceTargetsConnectionWhere
  """
  Return Sources where some of the related SourceInterfaceTargetsConnections match this filter
  """
  targetsConnection_SOME: SourceInterfaceTargetsConnectionWhere
  """Return Sources where all of the related Targets match this filter"""
  targets_ALL: TargetWhere
  """Return Sources where none of the related Targets match this filter"""
  targets_NONE: TargetWhere
  """Return Sources where one of the related Targets match this filter"""
  targets_SINGLE: TargetWhere
  """Return Sources where some of the related Targets match this filter"""
  targets_SOME: TargetWhere
}

type SourcesConnection {
  edges: [SourceEdge!]!
  pageInfo: PageInfo!
  totalCount: Int!
}

type Target {
  id: ID
}

type TargetAggregateSelection {
  count: Int!
  id: IDAggregateSelection!
}

input TargetConnectOrCreateWhere {
  node: TargetUniqueWhere!
}

input TargetConnectWhere {
  node: TargetWhere!
}

input TargetCreateInput {
  """
  Appears because this input type would be empty otherwise because this type is composed of just generated and/or relationship properties. See https://neo4j.com/docs/graphql-manual/current/troubleshooting/faqs/
  """
  _emptyInput: Boolean
}

type TargetEdge {
  cursor: String!
  node: Target!
}

input TargetOnCreateInput {
  """
  Appears because this input type would be empty otherwise because this type is composed of just generated and/or relationship properties. See https://neo4j.com/docs/graphql-manual/current/troubleshooting/faqs/
  """
  _emptyInput: Boolean
}

input TargetOptions {
  limit: Int
  offset: Int
  """
  Specify one or more TargetSort objects to sort Targets by. The sorts will be applied in the order in which they are arranged in the array.
  """
  sort: [TargetSort!]
}

"""
Fields to sort Targets by. The order in which sorts are applied is not guaranteed when specifying many fields in one TargetSort object.
"""
input TargetSort {
  id: SortDirection
}

input TargetUniqueWhere {
  id: ID
}

input TargetUpdateInput {
  """
  Appears because this input type would be empty otherwise because this type is composed of just generated and/or relationship properties. See https://neo4j.com/docs/graphql-manual/current/troubleshooting/faqs/
  """
  _emptyInput: Boolean
}

input TargetWhere {
  AND: [TargetWhere!]
  NOT: TargetWhere
  OR: [TargetWhere!]
  id: ID
  id_CONTAINS: ID
  id_ENDS_WITH: ID
  id_IN: [ID]
  id_STARTS_WITH: ID
}

type TargetsConnection {
  edges: [TargetEdge!]!
  pageInfo: PageInfo!
  totalCount: Int!
}

"""
Information about the number of nodes and relationships created and deleted during an update mutation
"""
type UpdateInfo {
  nodesCreated: Int!
  nodesDeleted: Int!
  relationshipsCreated: Int!
  relationshipsDeleted: Int!
}

type UpdateSourcesMutationResponse {
  info: UpdateInfo!
  sources: [Source!]!
}

type UpdateTargetsMutationResponse {
  info: UpdateInfo!
  targets: [Target!]!
}
----

'''
