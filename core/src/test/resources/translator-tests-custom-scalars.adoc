:toc:

= Translator Tests

== Schema

[source,graphql,schema=true]
----
scalar Date
type Movie {
  _id: ID!
  title: String!
  released: Date
}
----

== Tests

=== Create

.GraphQL-Query
[source,graphql]
----
mutation {
  createMovie(title:"Forrest Gump", released: 1994) {
    title
    released
  }
}
----

.Cypher params
[source,json]
----
{
  "createMovie_released" : 1994,
  "createMovie_title" : "Forrest Gump"
}
----

.Cypher
[source,cypher]
----
CREATE (createMovie:Movie  {
	title: $createMovie_title,
	released: $createMovie_released
})
WITH createMovie
RETURN createMovie {
	.title,
	.released
} AS createMovie
----

=== Update

.GraphQL-Query
[source,graphql]
----
mutation {
  updateMovie(_id: 1, released: 1995) {
    title
    released
  }
}
----

.Cypher params
[source,json]
----
{
  "updateMovie__id" : 1,
  "updateMovie_released" : 1995
}
----

.Cypher
[source,cypher]
----
MATCH (updateMovie:Movie)
WHERE id(updateMovie) = toInteger($updateMovie__id)
SET updateMovie +=  {
	released: $updateMovie_released
}
WITH updateMovie
RETURN updateMovie {
	.title,
	.released
} AS updateMovie
----

=== Merge

.GraphQL-Query
[source,graphql]
----
mutation {
  mergeMovie(_id: 1, released: 1995) {
    title
    released
  }
}
----

.Cypher params
[source,json]
----
{
  "mergeMovie__id" : 1,
  "mergeMovie_released" : 1995
}
----

.Cypher
[source,cypher]
----
MATCH (mergeMovie:Movie)
WHERE id(mergeMovie) = toInteger($mergeMovie__id)
SET mergeMovie +=  {
	released: $mergeMovie_released
}
WITH mergeMovie
RETURN mergeMovie {
	.title,
	.released
} AS mergeMovie
----

=== Merge null

.GraphQL-Query
[source,graphql]
----
mutation {
  updateMovie(_id: 1, released: null) {
    title
    released
  }
}
----

.Cypher params
[source,json]
----
{
  "updateMovie__id" : 1,
  "updateMovie_released" : null
}
----

.Cypher
[source,cypher]
----
MATCH (updateMovie:Movie)
WHERE id(updateMovie) = toInteger($updateMovie__id)
SET updateMovie +=  {
	released: $updateMovie_released
}
WITH updateMovie
RETURN updateMovie {
	.title,
	.released
} AS updateMovie
----

=== Find

.GraphQL-Query
[source,graphql]
----
{
  movie(released: 1994) {
    title
    released
  }
}
----

.Cypher params
[source,json]
----
{
  "movie_released" : 1994
}
----

.Cypher
[source,cypher]
----
MATCH (movie:Movie)
WHERE movie.released = $movie_released
RETURN movie {
	.title,
	.released
} AS movie
----

=== Filter

.GraphQL-Query
[source,graphql]
----
{
  movie(filter:{released_gte: 1994}) {
    title
    released
  }
}
----

.Cypher params
[source,json]
----
{
  "filter_movie_released_gte" : 1994
}
----

.Cypher
[source,cypher]
----
MATCH (movie:Movie)
WHERE movie.released >= $filter_movie_released_gte
RETURN movie {
	.title,
	.released
} AS movie
----

